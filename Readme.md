# Личный проект «Шесть городов»

* Студент: [Алексей Куликов](https://up.htmlacademy.ru/nodejs-api/2/user/927861).
* Наставник: [Дмитрий (sench) Железцов](https://htmlacademy.ru/profile/sench).

## Запуск проекта

### Запуск сервиса 

Для запуска сервиса необходимо создать файл .env в корне проекта, в котором задать значения переменных окружения на основе предоставленного описания в данном руководстве (см. секцию Переменные окружения). За основу можно взять .env.example. Установить зависимости проекат - npm i. Далее выполнить команду npm start.

### CLI

Программа для подготовки данных для сервиса. Запуск: npm run cli -- --<command> [--arguments]
Поддерживает следующие команды:

#### --version 
- Выводит информацию о версии приложения. Пример: npm run cli -- --version

#### --help
- Печатает справочную информацию по поддерживаемым командам

#### --import <filepath> <login> <password> <host> <dbname> <salt>
- Импортирует в базу данных информацию из tsv-файла с моковыми данными.
<filepath> - пусть к файлу с моковыми данными
<login> - пользователь БД
<password> - пароль пользователя БД
<host> - хост БД
<dbname> - название базы данных, в которую будет осущесвляться импорт моков
<salt> - соль для хэширования паролей пользователей
Пример: npm run cli -- --import ./mocks/mock-data.tsv admin test 127.0.0.1 six-cities secret

#### --generate <n> <filepath> <url>
- Создаёт файл в формате tsv с моковыми данными. Для работы команды необходимо запустить моковый сервер (команда npm run mock:server). 
<n> - количество генерируемых предложений
<filepath> - пусть к генерируемому файлу моков
<url> - url мокового сервера
Пример: npm run cli -- --generate 10 ./mocks/mock-data.tsv  http://localhost:3123/api

## Сценарии

### start
- осущестляет сборку и запуск сервиса

```bash
npm start
```

### cli
- осущестляет запуск CLI проекта

```bash
npm run cli
```

### start:dev
- осуществляет запуск сервиса в режиме разработки с использованием nodemon для отслеживания изменений в проекте и автоматического перезапуска сервиса.

```bash
npm run start:dev
```

### build
- осуществляет сборку проекта в папку ./dist

```bash
npm run build
```

### lint
- осуществляет проверку линтером кода проекта

```bash
npm run lint
```

### compile
- осуществляет компиляцию ts кода проекта на основе tsconfig.json

```bash
npm run compile
```

### clean
- осуществляет очистку папки ./dist

```bash
npm run clean
```

### ts
- осуществляет запуск ts кода проекта при помощи ts-node

```bash
npm run ts 
```

### mock:server
- осуществляет запуск mock-сервера, для подготовки моковых данных

```bash
npm run mock:server
```

## Переменные окружения

### HOST=127.0.0.1 
- хост, на котором запускается сервер. Значение по умолчанию 127.0.0.1

### PORT=4000 
- порт, на котором запускается сервер. Значение по умолчанию 4000

### SALT=some_salt 
- соль для хэширования пароля пользователя

### DB_HOST=127.0.0.1 
- хост, на котором запускается сервер базы данных (mongodb). Значение по умолчанию 127.0.0.1

### DB_PORT=27017 
- порт, на котором запускается сервер базы данных (mongodb). Значение по умолчанию 27017

### DB_USER=admin 
- имя пользователя с правами администратора базы данных

### DB_PASSWORD=test 
- пароль администратора базы данных

### DB_NAME=six-cities 
- название базы данных проекта

### UPLOAD_DIRECTORY=upload 
- папка для хранения загруженных файлов проекта. Значение по умолчанию upload

### STATIC_DIRECTORY=static 
- папка для хранения статических файлов проекта. Значение по умолчанию static

### JWT_SECRET=some_secret 
- секретный ключ для формирования подписи токена JWT
